webpackJsonp([94,218],{169:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n,i){for(var o=new PIXI.Container,a=new PIXI.filters.ColorMatrixFilter,r=n||!1,d=i||{addArrow:!1,type:"horizontal",scale:1},l=new PIXI.Container,s=0;s<3;++s){var h=s+1,c=PIXI.Sprite.fromFrame("TAP_1"+h);c.x=-c.width/2,c.y=-c.height/2;var p=new PIXI.Container;p.addChild(c),l.addChild(p)}var v=0;if(d.direction)switch(d.direction){case"top":v=-Math.PI/2;break;case"bottom":v=Math.PI/2;break;case"left":v=Math.PI;break;case"right":v=0;break;default:v=0}l.filters=[a];for(var f=0;f<l.children.length;f++){var u=l.children[f];u.scale.x=u.scale.y=2,f<2&&g(u,.75*f)}if(o.addChild(l),d.addArrow){var b,m;if(d.direction){b=PIXI.Sprite.fromFrame("oneArrow"),m=new PIXI.extras.MovieClip([b]);var T=d.scale?d.scale:1;m.scale.x=m.scale.y=T,m.pivot={x:0,y:m.height/2},m.rotation=v}else{b=PIXI.Sprite.fromFrame("NBarrow"),(m=new PIXI.extras.MovieClip([b])).pivot={x:m.width/2,y:m.height/2};var N=d.scale?d.scale:1;m.scale.x=m.scale.y=N,"horizontal"!==(d.type?d.type:"horizontal")&&(m.rotation=Math.PI/2)}o.addChild(m),o.arrow=m,o.addEventListener("hideArrow",function(){m.alpha=0,m.visible=!1}),o.addEventListener("showArrow",function(){m.alpha=1,m.visible=!0})}l.alpha=.4;var y=new PIXI.Graphics;function g(t,e){TweenMax.to(t,1.5,{delay:e,alpha:0,repeat:-1}),TweenMax.to(t.scale,1.5,{x:5,y:5,delay:e,repeat:-1})}return y.beginFill(16776960,0),y.drawRect(-50,-50,100,100),o.addChild(y),o.addEventListener(MouseEvent.MOUSE_OVER,function(){l.alpha=.6}),o.addEventListener(MouseEvent.MOUSE_OUT,function(){l.alpha=.4}),o.addEventListener(TouchEvent.TOUCH_BEGIN,function(){o.emit(o.event.TAP),!r&&o.parent&&o.parent.removeChild(o)}),o.x=t,o.y=e,o.setColor=function(t){var e=t>>16,n=t>>8&255,i=255&t;a._loadMatrix([e,0,0,0,0,0,n,0,0,0,0,0,i,0,0,0,0,0,255,0],!1),l.filters=[a]},o.setRotation=function(t){o.rotation=t},o.showAllDir=function(){if(d.direction)for(var t=0;t<3;t++){var e=new PIXI.Container;e.addChild(PIXI.Sprite.fromFrame("oneArrow")),o.addChild(e),e.pivot={x:0,y:m.height/2},e.rotation=Math.PI/2*(t+1)}else{var n=new PIXI.Container;n.addChild(PIXI.Sprite.fromFrame("NBarrow")),o.addChild(n),n.pivot={x:m.width/2,y:m.height/2},n.rotation=o.rotation+Math.PI/2}},o.event={TAP:"pointTap",HIDEARR:"hideArrow",SHOWARR:"showArrow"},instance.info&&instance.info.newLayOut&&o.scale.set(.6,.6),o}},242:function(t,e,n){"use strict";var i=function(t){return t&&t.__esModule?t:{default:t}}(n(169));nb.substance0041=extendsClass(ScienceMain,{frame0:function(){var t=this,e=new nb.SimpleElecPlugin(this);window.elec=e,this.l0.setAnchorOffset(0,-80),this.l1.setAnchorOffset(0,80);var n=(0,i.default)(-50,-20,!0);this.pin.addChild(n),this.pin.Point=n;var o=(0,i.default)(0,0,!0),a=(0,i.default)(0,0,!0);t.boardpin.pinHit.alpha=0,this.boardpin.visible=!1,this.boardpin.follow.alpha=0,e.disConnectNode(t.node2,t.node3),this.onUpdate=function(){t.setChildIndex(t.boardpin,t.children.length-1),e.render();var n=t.l0.bottom.hitTest(t.node0)&&t.l0.top.hitTest(t.node1),i=t.l0.bottom.hitTest(t.node1)&&t.l0.top.hitTest(t.node0),o=t.l1.bottom.hitTest(t.node0)&&t.l1.top.hitTest(t.node1),a=t.l1.bottom.hitTest(t.node1)&&t.l1.top.hitTest(t.node0);e.checkConnect(t.node0,t.node1)&&t.flag?(t.light.alpha=1,t.complete=!0):(n||i||o||a)&&e.checkConnect(t.node0,t.node1)?(t.light.alpha=1,t.complete=!0):t.light.alpha=0},NBDrag.addDrag(this.pin),this.pin.addEventListener(NBDrag.event.STOP_DRAG,function(){this.hitTest(t.board)?(NBDrag.removeDrag(this),this.visible=!1,t.boardpin.visible=!0,t.pin.isHit=!0,e.disConnectNode(t.node2,t.node3),NBGesture.addGesture(t.boardpin,NBGesture.gesture.TAP,function(){t.boardpin.removeChild(t.boardpin.boardpin),p(),t.boardpin.pinHit.hitTest(t.node2)?(t.flag=!1,TweenMax.to(t.boardpin,.5,{rotation:0}),e.disConnectNode(t.node2,t.node3)):TweenMax.to(t.boardpin,.5,{rotation:-24.7/180*Math.PI,onComplete:function(){t.setChildIndex(t.boardpin,t.children.length-1),e.connectNode(t.node2,t.node3),t.flag=!0}})})):t.pin.addChild(n),v()}),this.pin.addEventListener(NBDrag.event.START_DRAG,function(){t.pin.removeChild(n),p()});for(var r=[t.tool,t.l0,t.l1,t.board],d=0;d<r.length-1;d++){var l=r[d];l.addEventListener(TouchEvent.TOUCH_BEGIN,p),l.addEventListener(TouchEvent.TOUCH_END,v),l.addEventListener(TouchEvent.TOUCH_OUTSIDE,v)}for(var s=[t.l0.top,t.l0.bottom,t.l1.top,t.l1.bottom],h=0;h<4;h++){var c=s[h];c.addEventListener(NBDrag.event.START_DRAG,function(){p(),this.Point&&this.removeChild(this.Point)}),c.addEventListener(NBDrag.event.STOP_DRAG,v)}function p(){instance.NBDownTip.hideTip()}function v(){if(t.pin.isHit)if(e.checkConnect(t.node1,t.node2)&&e.checkConnect(t.node0,t.node3)||e.checkConnect(t.node1,t.node3)&&e.checkConnect(t.node0,t.node2)||t.complete){if(!e.connectNode(t.node2,t.node3)&&!t.complete){instance.NBDownTip.showTip("闭合开关观察现象");var n=(0,i.default)(-60,-30,!0);t.boardpin.addChild(n),t.boardpin.boardpin=n}}else{var r=t.l0.top.isMoveOk&&t.l0.bottom.isMoveOk,d=t.l0.top.isMoveOk&&t.l1.bottom.isMoveOk,l=t.l1.top.isMoveOk&&t.l0.bottom.isMoveOk,s=t.l1.top.isMoveOk&&t.l1.bottom.isMoveOk;r||d||l||s?instance.NBDownTip.showTip("用导线连接开关、灯泡、电池"):(instance.NBDownTip.showTip("用导线连接开关、灯泡、电池"),t.l0.top.isMoveOk||t.l1.top.isMoveOk?t.l0.bottom.isMoveOk||t.l1.bottom.isMoveOk||(t.l0.bottom.addChild(a),t.l0.bottom.Point=a):(t.l0.top.addChild(o),t.l0.top.Point=o))}else instance.NBDownTip.showTip("将回形针放置到钉有大头针的木板上")}},start:function(){this.menu.addStepFromObj(this.info),this.menu.setExperimentName(this.info.labName),this.showExperimentImport(this.info.experimentImport),this.bindScriptToSprite(this.frame0,"frame0")},info:{experimentImport:"开关是电路的重要组成部分,开关可以用来连通或断开电路，控制电路中电器元件的工作状态。",labName:"做个小开关",title0:"组成简易电路",CONCLUSION:"接通电路的部分需要用导体来做，手要接触的地方必须用绝缘体来做。开关闭合接通电路，开关中的导体部分让电流通过。"},const:{},event:{}}),nb.elecWire=function(){var t=this,e=[10624275,11814208,13402495,14462125],n=this.top,i=this.bottom;n.groupNode=i;var o=n.showNode,a=[];n.hideNode=o,o=i.showNode,i.hideNode=o,i.groupNode=n;var r={x:n.x+i.x>>1,y:n.y+i.y>>1},d={x:.01,y:0},l=new PIXI.Graphics;this.addChildAt(l,0),this.graphics=l;var s=0,h=Math.atan2(n.y-i.y,n.x-i.x);function c(t){if(!1!==nb.elecWire.allowDragWire){t.stopPropagation();var e=!1;null==n.bind&&null==i.bind||(e=!1);var o={x:t.data.global.x,y:t.data.global.y},a=function(t){if(e){var a={x:t.data.global.x-o.x,y:t.data.global.y-o.y};n.x+=a.x,n.y+=a.y,i.x+=a.x,i.y+=a.y}else{var r={x:t.data.global.x-o.x,y:t.data.global.y-o.y},l=NBMath.rotaPoint(r,{x:0,y:0},-s);d.x+=l.x,d.y+=l.y}o.x=t.data.global.x,o.y=t.data.global.y},r=function t(){l.removeListener(TouchEvent.TOUCH_MOVE,a),l.removeListener(TouchEvent.TOUCH_END,t),l.removeListener(TouchEvent.TOUCH_END_OUDSIDE,t)};this.addEventListener(TouchEvent.TOUCH_MOVE,a),this.addEventListener(TouchEvent.TOUCH_END_OUDSIDE,r),this.addEventListener(TouchEvent.TOUCH_END,r)}}function p(e){var n=e.target;n.parent.emit("nodeStartDrag"),n.clearBind(),this.parent.parent&&this.parent.parent.addChild(this.parent),function(){for(var e=t.core.nodeAry,n=0;n<e.length;n++)e[n].showHint()}(),this.Point&&(this.removeChild(this.Point),this.Point=null)}this.setAnchorOffset=function(t,e){d.x=t,d.y=e},this.excludeNodes=function(t){for(var e=0;e<t.length;e++)a.push(t[e])},l.addEventListener(TouchEvent.TOUCH_BEGIN,c),this.removeGraphicsEvent=function(){l.removeListener(TouchEvent.TOUCH_BEGIN,c)},NBDrag.addDrag(n),NBDrag.addDrag(i),n.addEventListener(NBDrag.event.START_DRAG,p),n.addEventListener(NBDrag.event.DRAG_MOVE,f),n.addEventListener(NBDrag.event.STOP_DRAG,u),i.addEventListener(NBDrag.event.START_DRAG,p),i.addEventListener(NBDrag.event.DRAG_MOVE,f),i.addEventListener(NBDrag.event.STOP_DRAG,u);var v=!1;function f(e){for(var n=e.target,i=t.core.nodeAry,o=this.toGlobal({x:0,y:0}),r=0;r<i.length;r++){v=!1;var d=i[r];if(!d.isFull()&&-1===a.indexOf(d)){var l=d.toGlobal({x:0,y:0});if(NBPoint.distance(l,o)<$s(40)){v=!0;var s=this.parent.toLocal(l,instance.stage);return this.x=s.x,this.y=s.y,void(n._node=d)}}}n._node=null}function u(e){var n=e.target;n.parent.emit("nodeStopDrag",{isConnected:v}),n._node&&(n._node.bind(n),n.getChildAt(0).alpha=0),function(){for(var e=t.core.nodeAry,n=0;n<e.length;n++)e[n].hideHint()}(),this.isMoveOk=!0}var b={x:0,y:0};this.render=function(){if(n.bindData.length>0){var t=n.bindData[0].toGlobal({x:0,y:0});t=this.toLocal(t,instance.stage),n.x=t.x,n.y=t.y}if(i.bindData.length>0){var o=i.bindData[0].toGlobal({x:0,y:0});o=this.toLocal(o,instance.stage),i.x=o.x,i.y=o.y}l.clear();var a=Math.atan2(n.y-i.y,n.x-i.x);s=a-h;var c=NBMath.rotaPoint(d,{x:0,y:0},s),p=e.length,v={x:(n.x+i.x>>1)+c.x,y:(n.y+i.y>>1)+c.y},f=.05*(v.x-r.x),u=.05*(v.y-r.y);b.x+=f,b.y+=u,r.x+=b.x,r.y+=b.y,b.x*=.92,b.y*=.92;for(var m=0;m<p;m++)l.lineStyle(2*(p-m-1)-1,e[m],1),l.moveTo(n.x,n.y),l.bezierCurveTo(n.x,n.y,r.x,r.y,i.x,i.y);l.lineStyle(1,0,0),l.beginFill(16711680,0);var T={x:n.x,y:n.y},N=NBPoint.interpolate(r,T,1),y=NBMath.rotaPoint(N,T,Math.PI/2),g=NBMath.rotaPoint(N,T,-Math.PI/2);p=$s(50),y=NBPoint.interpolate(y,T,p/NBPoint.distance(y,T)),g=NBPoint.interpolate(g,T,p/NBPoint.distance(g,T)),T={x:i.x,y:i.y},N=NBPoint.interpolate(r,T,1);var x=NBMath.rotaPoint(N,T,Math.PI/2),D=NBMath.rotaPoint(N,T,-Math.PI/2),E=NBPoint.interpolate(x,T,p/NBPoint.distance(x,T)),C=NBPoint.interpolate(D,T,p/NBPoint.distance(D,T)),O={x:n.x+i.x>>1,y:n.y+i.y>>1},P=NBPoint.interpolate(O,v,p/NBPoint.distance(v,O)),w=NBPoint.interpolate(O,v,-p/NBPoint.distance(v,O));if(d.x<0){var B=P;P=w,w=B}l.moveTo(y.x,y.y),l.bezierCurveTo(y.x,y.y,P.x,P.y,C.x,C.y),l.lineTo(E.x,E.y),l.bezierCurveTo(E.x,E.y,w.x,w.y,g.x,g.y)}},nb.SimpleElecPlugin=function(t,e){this.connectNode=function(t,e){t.groupNode=e,e.groupNode=t},this.disConnectNode=function(t,e){delete t.groupNode,delete e.groupNode},t.core=this,this.config=e||{};var n=[],i=[];this.nodeAry=i,function t(e){for(var o=0;o<e.children.length;o++){var a=e.children[o];t.apply(this,[a]);var r=a.linkageClassName;if(r&&(0===r.indexOf("nb.elecWire")?(n.push(a),a.core=this):0===r.indexOf("nb.elecLamp")?(this.connectNode(a.nodeLeft,a.nodeRight),a.nodeLeft.lamp=a,a.nodeRight.lamp=a):0===r.indexOf("nb.elecPower")&&(this.connectNode(a.nodeLeft,a.nodeRight),a.nodeLeft.power=a,a.nodeRight.power=a)),void 0!==a.elecType)switch(a.elecType){case nb.elecType.BLACK_WIRE_NODE:case nb.elecType.RED_WIRE_NODE:i.push(a),a.core=this}}}.apply(this,[t]),this.render=function(){for(var t=n.length,e=0;e<t;e++)n[e].render()},this.checkConnect=function(t,e,n){for(var i=t,o=[t],a=[],r=[],d=[],l=[];;){var s=i.bindData[0];if(-1!==o.indexOf(s)&&(s=i.groupNode,-1!==o.indexOf(s)))return!1;if(!s)return!1;if(void 0!==s.lamp?-1===a.indexOf(s.lamp)?a.push(s.lamp):r.push(s.lamp):void 0!==s.power&&(-1===d.indexOf(s.power)?d.push(s.power):l.push(s.power)),o.push(s),(i=s)===e)return n&&(n.lampAry=r,n.powerAry=l),!0}},this.pointConnect=function(t,e){return!!t.hitTest(e)}},nb.elecNode=function(){this.bindData=[],this.showNode=function(){this.getChildAt(0).alpha=1},this.hideNode=function(){this.getChildAt(0).alpha=0},this.showHint=function(){if(this.core.config.useNodeHint&&void 0===this.hint){var t=new PIXI.Graphics;t.lineStyle($s(6),16777215,.5),t.drawCircle(0,0,$s(20)),this.hint=t,this.hint.visible=!1,this.addChild(t)}this.hint&&(this.hint.visible=!0)},this.hideHint=function(){this.hint&&(this.hint.visible=!1)},this.bind=function(t){this.bindData.push(t),t.bindData.push(this),this.showNode()},this.clearBind=function(){var t=this.bindData.pop();t&&(t.removeBind(this),this.removeBind(t),this.hideNode())},this.removeBind=function(t){var e=this.bindData.indexOf(t);-1!==e&&(this.bindData.splice(e,1),this.hideNode())},this.isFull=function(){return this.bindData.length>=1}},nb.elecBlackNode=function(){this.elecType=nb.elecType.BLACK_WIRE_NODE,nb.elecNode.apply(this),this.hideNode()},nb.elecRedNode=function(){this.elecType=nb.elecType.RED_WIRE_NODE,nb.elecNode.apply(this),this.hideNode()},nb.elecLamp=function(){},nb.elecPower=function(){},nb.elecType={BLACK_WIRE_NODE:1,RED_WIRE_NODE:2},t.exports=nb.substance0041},298:function(t,e,n){"use strict";(function(e){var i=function(t){return t&&t.__esModule?t:{default:t}}(n(169));n(242),nb.substance0036=extendsClass(ScienceMain,{frame0:function(){var t=this;NBDrag.addDrag(t.lamp),NBDrag.addDrag(t.battery);var n=(0,i.default)(t.lamp.width/2-13,t.lamp.height/2-70,!0);t.lamp.addChild(n),t.lamp.Point=n;var o=(0,i.default)(0,0,!0),a=(0,i.default)(0,0,!0),r=(0,i.default)(t.battery.width/2,t.battery.height/2-50,!0),d=new nb.SimpleElecPlugin(this);e.elec=d,n.scale.x=n.scale.y=r.scale.x=r.scale.y=1,d.connectNode(t.node1,t.node2),this.l0.setAnchorOffset(-50,0),this.l1.setAnchorOffset(50,0),t.lamp.hit=!1,t.battery.hit=!1;var l={};function s(){instance.NBDownTip.hideTip(),instance.NBDownTipsError.hideTip()}function h(){if(d.checkConnect(t.node3,t.node4)&&t.battery.hitTest(t.batteryHolder)){var e=t.l0.top.hitTest(t.node3)&&t.l0.bottom.hitTest(t.node4),n=t.l0.top.hitTest(t.node4)&&t.l0.bottom.hitTest(t.node3),i=t.l1.top.hitTest(t.node3)&&t.l1.bottom.hitTest(t.node4),o=t.l1.top.hitTest(t.node4)&&t.l1.bottom.hitTest(t.node3);return!!(e||n||i||o)&&(instance.NBDownTipsError.showTip("短路会发热变烫，电池很快就会被损坏。请断开"),!0)}}t.lamp.on(NBDrag.event.STOP_DRAG,function(){this.hitTest(t.lampHolder)&&(t.lamp.removeChild(n),n=null,t.lamp.hit=!0,this.parent.removeChild(this),t.lampHolder.gotoAndStop(1)),f()}),t.lamp.addEventListener(NBDrag.event.START_DRAG,function(){s(),t.lamp.removeChild(n)}),t.battery.addEventListener(NBDrag.event.START_DRAG,function(){s(),t.battery.removeChild(r)}),t.battery.on(NBDrag.event.STOP_DRAG,function(){s(),this.hitTest(t.batteryHolder)&&(this.parent.removeChild(this),t.batteryHolder.gotoAndStop(1),t.battery.hit=!0),f(),h()}),t.l0.top.addEventListener(NBDrag.event.START_DRAG,p),t.l0.bottom.addEventListener(NBDrag.event.START_DRAG,p),t.l1.top.addEventListener(NBDrag.event.START_DRAG,p),t.l1.bottom.addEventListener(NBDrag.event.START_DRAG,p),t.l0.top.addEventListener(NBDrag.event.STOP_DRAG,v),t.l0.bottom.addEventListener(NBDrag.event.STOP_DRAG,v),t.l1.top.addEventListener(NBDrag.event.STOP_DRAG,v),t.l1.bottom.addEventListener(NBDrag.event.STOP_DRAG,v),t.lampHolder.addEventListener(TouchEvent.TAP,f),t.batteryHolder.addEventListener(TouchEvent.TAP,f);var c=[];function p(){s(),this.Point&&this.removeChild(this.Point),-1===c.indexOf(this.arrFlag)&&c.push(this.arrFlag),4===c.length&&(t.txt.alpha=0)}function v(){"bottom"===this.name?this.bottomOK=!0:this.topOk=!0,f(),h()}function f(){if(t.lamp.hit)if(t.battery.hit){if(!d.checkConnect(t.node3,t.node1,l)||!d.checkConnect(t.node3,t.node4,l)){var e=t.l0.top.topOk&&t.l0.bottom.bottomOK,i=t.l0.top.topOk&&t.l1.bottom.bottomOK,s=t.l1.top.topOk&&t.l0.bottom.bottomOK,h=t.l1.top.topOk&&t.l1.bottom.bottomOK;e||i||s||h?instance.NBDownTip.showTip("拖动导线连接灯座和电池座，使灯泡亮起来"):(instance.NBDownTip.showTip("拖动导线连接灯座和电池座，使灯泡亮起来"),t.l0.top.topOk||t.l1.top.topOk?t.l0.bottom.topOk||t.l1.bottom.topOk||(t.l0.bottom.addChild(a),t.l0.bottom.Point=a):(t.l0.top.addChild(o),t.l0.top.Point=o))}}else instance.NBDownTip.showTip("将电池拖动到电池座上"),t.battery.addChild(r),t.battery.Point=r;else instance.NBDownTip.showTip("将小灯泡拖动到灯座上"),t.lamp.addChild(n),t.lamp.Point=n}t.l0.top.arrFlag=0,t.l0.bottom.arrFlag=1,t.l1.top.arrFlag=2,t.l1.bottom.arrFlag=3,this.onUpdate=function(){d.render();var e={};d.checkConnect(t.node3,t.node1,e)&&d.checkConnect(t.node3,t.node4,e)&&1===t.lampHolder.currentFrame&&1===t.batteryHolder.currentFrame?t.lampHolder.light.alpha=1:t.lampHolder.light.alpha=0}},start:function(){this.menu.addStepFromObj(this.info),this.menu.setExperimentName(this.info.labName),this.bindScriptToSprite(this.frame0,"frame0")},info:{experimentImport:"我们的生活中，电路无处不在，有些电路非常复杂，有些则是很简单。我们可以尝试来连接一组电路。",labName:"带灯座的电路",title0:"组成一个电路是灯泡亮",CONCLUSION:"导线、电源、灯泡可以组成一个简单的电路。"},const:{},event:{}}),t.exports=nb.substance0036}).call(e,n(5))}});