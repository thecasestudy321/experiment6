webpackJsonp([218],{169:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,i){for(var o=new PIXI.Container,a=new PIXI.filters.ColorMatrixFilter,r=n||!1,d=i||{addArrow:!1,type:"horizontal",scale:1},s=new PIXI.Container,h=0;h<3;++h){var l=h+1,c=PIXI.Sprite.fromFrame("TAP_1"+l);c.x=-c.width/2,c.y=-c.height/2;var p=new PIXI.Container;p.addChild(c),s.addChild(p)}var v=0;if(d.direction)switch(d.direction){case"top":v=-Math.PI/2;break;case"bottom":v=Math.PI/2;break;case"left":v=Math.PI;break;case"right":v=0;break;default:v=0}s.filters=[a];for(var f=0;f<s.children.length;f++){var u=s.children[f];u.scale.x=u.scale.y=2,f<2&&T(u,.75*f)}if(o.addChild(s),d.addArrow){var b,y;if(d.direction){b=PIXI.Sprite.fromFrame("oneArrow"),y=new PIXI.extras.MovieClip([b]);var x=d.scale?d.scale:1;y.scale.x=y.scale.y=x,y.pivot={x:0,y:y.height/2},y.rotation=v}else{b=PIXI.Sprite.fromFrame("NBarrow"),(y=new PIXI.extras.MovieClip([b])).pivot={x:y.width/2,y:y.height/2};var N=d.scale?d.scale:1;y.scale.x=y.scale.y=N,"horizontal"!==(d.type?d.type:"horizontal")&&(y.rotation=Math.PI/2)}o.addChild(y),o.arrow=y,o.addEventListener("hideArrow",function(){y.alpha=0,y.visible=!1}),o.addEventListener("showArrow",function(){y.alpha=1,y.visible=!0})}s.alpha=.4;var g=new PIXI.Graphics;function T(e,t){TweenMax.to(e,1.5,{delay:t,alpha:0,repeat:-1}),TweenMax.to(e.scale,1.5,{x:5,y:5,delay:t,repeat:-1})}return g.beginFill(16776960,0),g.drawRect(-50,-50,100,100),o.addChild(g),o.addEventListener(MouseEvent.MOUSE_OVER,function(){s.alpha=.6}),o.addEventListener(MouseEvent.MOUSE_OUT,function(){s.alpha=.4}),o.addEventListener(TouchEvent.TOUCH_BEGIN,function(){o.emit(o.event.TAP),!r&&o.parent&&o.parent.removeChild(o)}),o.x=e,o.y=t,o.setColor=function(e){var t=e>>16,n=e>>8&255,i=255&e;a._loadMatrix([t,0,0,0,0,0,n,0,0,0,0,0,i,0,0,0,0,0,255,0],!1),s.filters=[a]},o.setRotation=function(e){o.rotation=e},o.showAllDir=function(){if(d.direction)for(var e=0;e<3;e++){var t=new PIXI.Container;t.addChild(PIXI.Sprite.fromFrame("oneArrow")),o.addChild(t),t.pivot={x:0,y:y.height/2},t.rotation=Math.PI/2*(e+1)}else{var n=new PIXI.Container;n.addChild(PIXI.Sprite.fromFrame("NBarrow")),o.addChild(n),n.pivot={x:y.width/2,y:y.height/2},n.rotation=o.rotation+Math.PI/2}},o.event={TAP:"pointTap",HIDEARR:"hideArrow",SHOWARR:"showArrow"},instance.info&&instance.info.newLayOut&&o.scale.set(.6,.6),o}},242:function(e,t,n){"use strict";var i=function(e){return e&&e.__esModule?e:{default:e}}(n(169));nb.substance0041=extendsClass(ScienceMain,{frame0:function(){var e=this,t=new nb.SimpleElecPlugin(this);window.elec=t,this.l0.setAnchorOffset(0,-80),this.l1.setAnchorOffset(0,80);var n=(0,i.default)(-50,-20,!0);this.pin.addChild(n),this.pin.Point=n;var o=(0,i.default)(0,0,!0),a=(0,i.default)(0,0,!0);e.boardpin.pinHit.alpha=0,this.boardpin.visible=!1,this.boardpin.follow.alpha=0,t.disConnectNode(e.node2,e.node3),this.onUpdate=function(){e.setChildIndex(e.boardpin,e.children.length-1),t.render();var n=e.l0.bottom.hitTest(e.node0)&&e.l0.top.hitTest(e.node1),i=e.l0.bottom.hitTest(e.node1)&&e.l0.top.hitTest(e.node0),o=e.l1.bottom.hitTest(e.node0)&&e.l1.top.hitTest(e.node1),a=e.l1.bottom.hitTest(e.node1)&&e.l1.top.hitTest(e.node0);t.checkConnect(e.node0,e.node1)&&e.flag?(e.light.alpha=1,e.complete=!0):(n||i||o||a)&&t.checkConnect(e.node0,e.node1)?(e.light.alpha=1,e.complete=!0):e.light.alpha=0},NBDrag.addDrag(this.pin),this.pin.addEventListener(NBDrag.event.STOP_DRAG,function(){this.hitTest(e.board)?(NBDrag.removeDrag(this),this.visible=!1,e.boardpin.visible=!0,e.pin.isHit=!0,t.disConnectNode(e.node2,e.node3),NBGesture.addGesture(e.boardpin,NBGesture.gesture.TAP,function(){e.boardpin.removeChild(e.boardpin.boardpin),p(),e.boardpin.pinHit.hitTest(e.node2)?(e.flag=!1,TweenMax.to(e.boardpin,.5,{rotation:0}),t.disConnectNode(e.node2,e.node3)):TweenMax.to(e.boardpin,.5,{rotation:-24.7/180*Math.PI,onComplete:function(){e.setChildIndex(e.boardpin,e.children.length-1),t.connectNode(e.node2,e.node3),e.flag=!0}})})):e.pin.addChild(n),v()}),this.pin.addEventListener(NBDrag.event.START_DRAG,function(){e.pin.removeChild(n),p()});for(var r=[e.tool,e.l0,e.l1,e.board],d=0;d<r.length-1;d++){var s=r[d];s.addEventListener(TouchEvent.TOUCH_BEGIN,p),s.addEventListener(TouchEvent.TOUCH_END,v),s.addEventListener(TouchEvent.TOUCH_OUTSIDE,v)}for(var h=[e.l0.top,e.l0.bottom,e.l1.top,e.l1.bottom],l=0;l<4;l++){var c=h[l];c.addEventListener(NBDrag.event.START_DRAG,function(){p(),this.Point&&this.removeChild(this.Point)}),c.addEventListener(NBDrag.event.STOP_DRAG,v)}function p(){instance.NBDownTip.hideTip()}function v(){if(e.pin.isHit)if(t.checkConnect(e.node1,e.node2)&&t.checkConnect(e.node0,e.node3)||t.checkConnect(e.node1,e.node3)&&t.checkConnect(e.node0,e.node2)||e.complete){if(!t.connectNode(e.node2,e.node3)&&!e.complete){instance.NBDownTip.showTip("闭合开关观察现象");var n=(0,i.default)(-60,-30,!0);e.boardpin.addChild(n),e.boardpin.boardpin=n}}else{var r=e.l0.top.isMoveOk&&e.l0.bottom.isMoveOk,d=e.l0.top.isMoveOk&&e.l1.bottom.isMoveOk,s=e.l1.top.isMoveOk&&e.l0.bottom.isMoveOk,h=e.l1.top.isMoveOk&&e.l1.bottom.isMoveOk;r||d||s||h?instance.NBDownTip.showTip("用导线连接开关、灯泡、电池"):(instance.NBDownTip.showTip("用导线连接开关、灯泡、电池"),e.l0.top.isMoveOk||e.l1.top.isMoveOk?e.l0.bottom.isMoveOk||e.l1.bottom.isMoveOk||(e.l0.bottom.addChild(a),e.l0.bottom.Point=a):(e.l0.top.addChild(o),e.l0.top.Point=o))}else instance.NBDownTip.showTip("将回形针放置到钉有大头针的木板上")}},start:function(){this.menu.addStepFromObj(this.info),this.menu.setExperimentName(this.info.labName),this.showExperimentImport(this.info.experimentImport),this.bindScriptToSprite(this.frame0,"frame0")},info:{experimentImport:"开关是电路的重要组成部分,开关可以用来连通或断开电路，控制电路中电器元件的工作状态。",labName:"做个小开关",title0:"组成简易电路",CONCLUSION:"接通电路的部分需要用导体来做，手要接触的地方必须用绝缘体来做。开关闭合接通电路，开关中的导体部分让电流通过。"},const:{},event:{}}),nb.elecWire=function(){var e=this,t=[10624275,11814208,13402495,14462125],n=this.top,i=this.bottom;n.groupNode=i;var o=n.showNode,a=[];n.hideNode=o,o=i.showNode,i.hideNode=o,i.groupNode=n;var r={x:n.x+i.x>>1,y:n.y+i.y>>1},d={x:.01,y:0},s=new PIXI.Graphics;this.addChildAt(s,0),this.graphics=s;var h=0,l=Math.atan2(n.y-i.y,n.x-i.x);function c(e){if(!1!==nb.elecWire.allowDragWire){e.stopPropagation();var t=!1;null==n.bind&&null==i.bind||(t=!1);var o={x:e.data.global.x,y:e.data.global.y},a=function(e){if(t){var a={x:e.data.global.x-o.x,y:e.data.global.y-o.y};n.x+=a.x,n.y+=a.y,i.x+=a.x,i.y+=a.y}else{var r={x:e.data.global.x-o.x,y:e.data.global.y-o.y},s=NBMath.rotaPoint(r,{x:0,y:0},-h);d.x+=s.x,d.y+=s.y}o.x=e.data.global.x,o.y=e.data.global.y},r=function e(){s.removeListener(TouchEvent.TOUCH_MOVE,a),s.removeListener(TouchEvent.TOUCH_END,e),s.removeListener(TouchEvent.TOUCH_END_OUDSIDE,e)};this.addEventListener(TouchEvent.TOUCH_MOVE,a),this.addEventListener(TouchEvent.TOUCH_END_OUDSIDE,r),this.addEventListener(TouchEvent.TOUCH_END,r)}}function p(t){var n=t.target;n.parent.emit("nodeStartDrag"),n.clearBind(),this.parent.parent&&this.parent.parent.addChild(this.parent),function(){for(var t=e.core.nodeAry,n=0;n<t.length;n++)t[n].showHint()}(),this.Point&&(this.removeChild(this.Point),this.Point=null)}this.setAnchorOffset=function(e,t){d.x=e,d.y=t},this.excludeNodes=function(e){for(var t=0;t<e.length;t++)a.push(e[t])},s.addEventListener(TouchEvent.TOUCH_BEGIN,c),this.removeGraphicsEvent=function(){s.removeListener(TouchEvent.TOUCH_BEGIN,c)},NBDrag.addDrag(n),NBDrag.addDrag(i),n.addEventListener(NBDrag.event.START_DRAG,p),n.addEventListener(NBDrag.event.DRAG_MOVE,f),n.addEventListener(NBDrag.event.STOP_DRAG,u),i.addEventListener(NBDrag.event.START_DRAG,p),i.addEventListener(NBDrag.event.DRAG_MOVE,f),i.addEventListener(NBDrag.event.STOP_DRAG,u);var v=!1;function f(t){for(var n=t.target,i=e.core.nodeAry,o=this.toGlobal({x:0,y:0}),r=0;r<i.length;r++){v=!1;var d=i[r];if(!d.isFull()&&-1===a.indexOf(d)){var s=d.toGlobal({x:0,y:0});if(NBPoint.distance(s,o)<$s(40)){v=!0;var h=this.parent.toLocal(s,instance.stage);return this.x=h.x,this.y=h.y,void(n._node=d)}}}n._node=null}function u(t){var n=t.target;n.parent.emit("nodeStopDrag",{isConnected:v}),n._node&&(n._node.bind(n),n.getChildAt(0).alpha=0),function(){for(var t=e.core.nodeAry,n=0;n<t.length;n++)t[n].hideHint()}(),this.isMoveOk=!0}var b={x:0,y:0};this.render=function(){if(n.bindData.length>0){var e=n.bindData[0].toGlobal({x:0,y:0});e=this.toLocal(e,instance.stage),n.x=e.x,n.y=e.y}if(i.bindData.length>0){var o=i.bindData[0].toGlobal({x:0,y:0});o=this.toLocal(o,instance.stage),i.x=o.x,i.y=o.y}s.clear();var a=Math.atan2(n.y-i.y,n.x-i.x);h=a-l;var c=NBMath.rotaPoint(d,{x:0,y:0},h),p=t.length,v={x:(n.x+i.x>>1)+c.x,y:(n.y+i.y>>1)+c.y},f=.05*(v.x-r.x),u=.05*(v.y-r.y);b.x+=f,b.y+=u,r.x+=b.x,r.y+=b.y,b.x*=.92,b.y*=.92;for(var y=0;y<p;y++)s.lineStyle(2*(p-y-1)-1,t[y],1),s.moveTo(n.x,n.y),s.bezierCurveTo(n.x,n.y,r.x,r.y,i.x,i.y);s.lineStyle(1,0,0),s.beginFill(16711680,0);var x={x:n.x,y:n.y},N=NBPoint.interpolate(r,x,1),g=NBMath.rotaPoint(N,x,Math.PI/2),T=NBMath.rotaPoint(N,x,-Math.PI/2);p=$s(50),g=NBPoint.interpolate(g,x,p/NBPoint.distance(g,x)),T=NBPoint.interpolate(T,x,p/NBPoint.distance(T,x)),x={x:i.x,y:i.y},N=NBPoint.interpolate(r,x,1);var m=NBMath.rotaPoint(N,x,Math.PI/2),E=NBMath.rotaPoint(N,x,-Math.PI/2),C=NBPoint.interpolate(m,x,p/NBPoint.distance(m,x)),P=NBPoint.interpolate(E,x,p/NBPoint.distance(E,x)),D={x:n.x+i.x>>1,y:n.y+i.y>>1},w=NBPoint.interpolate(D,v,p/NBPoint.distance(v,D)),O=NBPoint.interpolate(D,v,-p/NBPoint.distance(v,D));if(d.x<0){var I=w;w=O,O=I}s.moveTo(g.x,g.y),s.bezierCurveTo(g.x,g.y,w.x,w.y,P.x,P.y),s.lineTo(C.x,C.y),s.bezierCurveTo(C.x,C.y,O.x,O.y,T.x,T.y)}},nb.SimpleElecPlugin=function(e,t){this.connectNode=function(e,t){e.groupNode=t,t.groupNode=e},this.disConnectNode=function(e,t){delete e.groupNode,delete t.groupNode},e.core=this,this.config=t||{};var n=[],i=[];this.nodeAry=i,function e(t){for(var o=0;o<t.children.length;o++){var a=t.children[o];e.apply(this,[a]);var r=a.linkageClassName;if(r&&(0===r.indexOf("nb.elecWire")?(n.push(a),a.core=this):0===r.indexOf("nb.elecLamp")?(this.connectNode(a.nodeLeft,a.nodeRight),a.nodeLeft.lamp=a,a.nodeRight.lamp=a):0===r.indexOf("nb.elecPower")&&(this.connectNode(a.nodeLeft,a.nodeRight),a.nodeLeft.power=a,a.nodeRight.power=a)),void 0!==a.elecType)switch(a.elecType){case nb.elecType.BLACK_WIRE_NODE:case nb.elecType.RED_WIRE_NODE:i.push(a),a.core=this}}}.apply(this,[e]),this.render=function(){for(var e=n.length,t=0;t<e;t++)n[t].render()},this.checkConnect=function(e,t,n){for(var i=e,o=[e],a=[],r=[],d=[],s=[];;){var h=i.bindData[0];if(-1!==o.indexOf(h)&&(h=i.groupNode,-1!==o.indexOf(h)))return!1;if(!h)return!1;if(void 0!==h.lamp?-1===a.indexOf(h.lamp)?a.push(h.lamp):r.push(h.lamp):void 0!==h.power&&(-1===d.indexOf(h.power)?d.push(h.power):s.push(h.power)),o.push(h),(i=h)===t)return n&&(n.lampAry=r,n.powerAry=s),!0}},this.pointConnect=function(e,t){return!!e.hitTest(t)}},nb.elecNode=function(){this.bindData=[],this.showNode=function(){this.getChildAt(0).alpha=1},this.hideNode=function(){this.getChildAt(0).alpha=0},this.showHint=function(){if(this.core.config.useNodeHint&&void 0===this.hint){var e=new PIXI.Graphics;e.lineStyle($s(6),16777215,.5),e.drawCircle(0,0,$s(20)),this.hint=e,this.hint.visible=!1,this.addChild(e)}this.hint&&(this.hint.visible=!0)},this.hideHint=function(){this.hint&&(this.hint.visible=!1)},this.bind=function(e){this.bindData.push(e),e.bindData.push(this),this.showNode()},this.clearBind=function(){var e=this.bindData.pop();e&&(e.removeBind(this),this.removeBind(e),this.hideNode())},this.removeBind=function(e){var t=this.bindData.indexOf(e);-1!==t&&(this.bindData.splice(t,1),this.hideNode())},this.isFull=function(){return this.bindData.length>=1}},nb.elecBlackNode=function(){this.elecType=nb.elecType.BLACK_WIRE_NODE,nb.elecNode.apply(this),this.hideNode()},nb.elecRedNode=function(){this.elecType=nb.elecType.RED_WIRE_NODE,nb.elecNode.apply(this),this.hideNode()},nb.elecLamp=function(){},nb.elecPower=function(){},nb.elecType={BLACK_WIRE_NODE:1,RED_WIRE_NODE:2},e.exports=nb.substance0041}});